<?xml version="1.0" encoding="UTF-8"?> 
<?eclipse version="3.2"?>
<plugin>

   
   <extension point="org.eclipse.ui.commands">
	  <category name="SyncCharts" description="Commands related to SyncChart diagrams." id="org.eclipse.gmf.category.synccharts"/>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new OnEntryAction"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addEntryAction"
         name="Add OnEntryAction">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new OnInsideAction"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addInsideAction"
         name="Add OnInsideAction">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new OnExitAction"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addExitAction"
         name="Add OnExitAction">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new Signal"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addSignal"
         name="Add Signal">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new Variable"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addVariable"
         name="Add Variable">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
	  <command
         categoryId="org.eclipse.gmf.category.synccharts"
         defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.AddToStateHandler"
         description="Adds a new SuspensionTrigger"
         id="de.cau.cs.kieler.synccharts.custom.contextMenu.addSuspensionTrigger"
         name="Add SuspensionTrigger">
      <commandParameter
            id="de.cau.cs.kieler.synccharts.custom.parameters.type"
            name="Type"
            optional="false">
      </commandParameter>
	  </command>
         <command
            categoryId="de.cau.cs.kieler"
            defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.commands.InitSyncchartsDiagramHandler"
            description="Reinitialize the diagram for the selected kixs file overwriting the olds kids file."
            id="de.cau.cs.kieler.synccharts.ui.reinitDiagram"
            name="Reinitialize and save synccharts diagram">
      </command>
         <command
               categoryId="de.cau.cs.kieler"
               defaultHandler="de.cau.cs.kieler.synccharts.diagram.custom.handlers.ExpandMacroStatesCommand"
               description="Expand reference-macrostates"
               id="de.cau.cs.kieler.core.ui.expandMacroStates"
               name="Expand reference-macrostates">
         </command>
   </extension>
   
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            locationURI="popup:org.eclipse.gmf.runtime.diagram.ui.DiagramEditorContextMenu?after=addGroup">
         <command
               commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addSignal"
               icon="icons/obj16/Signal.gif"
               label="Add Signal"
               mnemonic="S"
               style="push"
               tooltip="Add a signal to the selected state, either input, output or a local signal.">
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
               </reference>
            </visibleWhen>
            <parameter
                  name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                  value="Signal">
            </parameter>
         </command>
         <command
               commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addVariable"
               icon="icons/obj16/Variable.gif"
               label="Add Variable"
               mnemonic="V"
               style="push"
               tooltip="Add a variable to the selected scope.">
            <visibleWhen
                  checkEnabled="false">
               <reference
                     definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
               </reference>
            </visibleWhen>
            <parameter
                  name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                  value="Variable">
            </parameter>
         </command>
         <menu
               id="customAddMenu"
               label="Add Action/Suspension"
               mnemonic="A">
            <command
                  commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addEntryAction"
                  icon="icons/obj16/Action.gif"
                  label="OnEntry Action"
                  mnemonic="t"
                  style="push"
                  tooltip="OnEntry actions are executed when control enters the state">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
                  </reference>
               </visibleWhen>
               <parameter
                     name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                     value="OnEntryAction">
               </parameter>
            </command>
            <command
                  commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addInsideAction"
                  icon="icons/obj16/Action.gif"
                  label="OnInside Action"
                  mnemonic="I"
                  style="push"
                  tooltip="OnInside actions are executed when control persists in the state">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
                  </reference>
               </visibleWhen>
               <parameter
                     name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                     value="OnInsideAction">
               </parameter>
            </command>
            <command
                  commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addExitAction"
                  icon="icons/obj16/Action.gif"
                  label="OnExit Action"
                  mnemonic="x"
                  style="push"
                  tooltip="OnExit actions are executed when control leaves the state">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
                  </reference>
               </visibleWhen>
               <parameter
                     name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                     value="OnExitAction">
               </parameter>
            </command>
            <command
                  commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addSuspensionTrigger"
                  icon="icons/obj16/Suspension.gif"
                  label="Suspension Trigger"
                  mnemonic="u"
                  style="push"
                  tooltip="When a suspension trigger is active, the contents of the state are suspended">
               <visibleWhen
                     checkEnabled="false">
                  <reference
                        definitionId="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
                  </reference>
               </visibleWhen>
               <parameter
                     name="de.cau.cs.kieler.synccharts.custom.parameters.type"
                     value="SuspensionTrigger">
               </parameter>
            </command>

         </menu>
        
      </menuContribution>
            <menuContribution
            locationURI="popup:org.eclipse.ui.popup.any?after=additions">
         <command
               commandId="de.cau.cs.kieler.synccharts.ui.reinitDiagram"
               label="Initialize GMF Diagram File (kids)"
               style="push"
               tooltip="Reinitialize the diagram for the selected SyncCharts model, overwriting any olds &apos;kids&apos; file.">
            <visibleWhen
                  checkEnabled="false">
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <adapt
                        type="org.eclipse.core.resources.IResource">
                     <or>
                        <test
                              forcePluginActivation="false"
                              property="org.eclipse.core.resources.extension"
                              value="kixs">
                        </test>
                        <test
                              forcePluginActivation="false"
                              property="org.eclipse.core.resources.extension"
                              value="kits">
                        </test></or>
                  </adapt>
               </iterate>
            </visibleWhen>
         </command>
         <command
               commandId="de.cau.cs.kieler.kiml.gmf.layoutDiagramFile"
               label="Layout the Diagram File"
               style="push"
               tooltip="Perform layout directly on the diagram file and store the result">
            <visibleWhen
                  checkEnabled="false">
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <adapt
                        type="org.eclipse.core.resources.IResource">
                    <test
                          forcePluginActivation="false"
                          property="org.eclipse.core.resources.extension"
                          value="kids">
                    </test>
                  </adapt>
               </iterate>
            </visibleWhen>
         </command>
      </menuContribution>
            <menuContribution
                  locationURI="menu:de.cau.cs.kieler">
               <command
                     commandId="de.cau.cs.kieler.synccharts.diagram.custom.hideTransitionLabels"
                     label="Hide Transition Priority Labels"
                     style="toggle">
                  <visibleWhen
                        checkEnabled="false">
                     <with
                           variable="activeEditor">
                        <test
                              forcePluginActivation="false"
                              property="de.cau.cs.kieler.synccharts.activeSyncchartsEditor">
                        </test>
                     </with>
                  </visibleWhen>
               </command>
            </menuContribution>
            <menuContribution
                  locationURI="popup:de.cau.cs.kieler">
               <command
                     commandId="de.cau.cs.kieler.core.ui.expandMacroStates"
                     label="Expand Reference Macro-States"
                     style="push"
                     tooltip="Expand reference-macrostates">
            <visibleWhen
                  checkEnabled="false">
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <adapt
                        type="org.eclipse.core.resources.IResource">
                     <or>
                        <test
                              forcePluginActivation="false"
                              property="org.eclipse.core.resources.extension"
                              value="kixs">
                        </test>
                        <test
                              forcePluginActivation="false"
                              property="org.eclipse.core.resources.extension"
                              value="kits">
                        </test></or>
                  </adapt>
               </iterate>
            </visibleWhen>
               </command>
            </menuContribution>
   </extension>
   <extension
         point="org.eclipse.core.expressions.definitions">
      <definition
            id="de.cau.cs.kieler.synccharts.custom.expressions.statePart">
	       <iterate
	             ifEmpty="false"
	             operator="and">
	          <or>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateEditPart">
	             </instanceof>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.RegionStateEditPart">
	             </instanceof>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateLabelEditPart">
	             </instanceof>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.RegionStateLabelEditPart">
	             </instanceof>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateRegionCompartmentEditPart">
	             </instanceof>
	             <instanceof
	                   value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateRegionCompartment2EditPart">
	             </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateEntryActionEditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateEntryAction2EditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateExitActionEditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateExitAction2EditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateInsideActionEditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateInsideAction2EditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateSignalEditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateSignal2EditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateSuspendEditPart">
              </instanceof>
              <instanceof
                    value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateSuspend2EditPart">
              </instanceof>
	          </or>
	       </iterate>
      </definition>
      <definition
            id="de.cau.cs.kieler.synccharts.custom.expressions.region">
         <iterate
               ifEmpty="false"
               operator="and">
            <or>
               <instanceof
                     value="de.cau.cs.kieler.synccharts.diagram.edit.parts.RegionEditPart">
               </instanceof>
               <instanceof
                     value="de.cau.cs.kieler.synccharts.diagram.edit.parts.StateRegionEditPart">
               </instanceof>
               <instanceof
                     value="de.cau.cs.kieler.synccharts.diagram.edit.parts.RegionStateCompartmentEditPart">
               </instanceof>
            </or>
         </iterate>
      </definition>
      <definition
            id="de.cau.cs.kieler.synccharts.diagram.isKsbaseInactive">
         <with
               variable="activeEditor">
            <test
                  forcePluginActivation="false"
                  property="de.cau.cs.kieler.synccharts.isKsbaseInactive">
            </test>
         </with>
      </definition>
   </extension>
   <extension
         point="org.eclipse.ui.bindings">
      <key
            commandId="de.cau.cs.kieler.synccharts.custom.contextMenu.addSignal"
            contextId="de.cau.cs.kieler.synccharts.diagram.ui.diagramContext"
            schemeId="org.eclipse.ui.defaultAcceleratorConfiguration"
            sequence="M1+R I">
         <parameter
               id="de.cau.cs.kieler.synccharts.custom.parameters.type"
               value="Signal">
         </parameter>
      </key>
   </extension>
   <extension
         point="de.cau.cs.kieler.kiml.layoutInfo">
      <option
            class="de.cau.cs.kieler.synccharts.Region"
            option="de.cau.cs.kieler.diagramType"
            value="de.cau.cs.kieler.layout.diagrams.stateMachine">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.diagramType"
            value="de.cau.cs.kieler.layout.diagrams.boxes">
      </option>
      <option
            class="de.cau.cs.kieler.core.kexpressions.Signal"
            option="de.cau.cs.kieler.noLayout"
            value="true">
      </option>
      <option
            class="de.cau.cs.kieler.core.kexpressions.Variable"
            option="de.cau.cs.kieler.noLayout"
            value="true">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.spacing"
            value="1.0">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.borderSpacing"
            value="1.0">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.sizeConstraint"
            value="MIN_OPTION">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.expandNodes"
            value="true">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.State"
            option="de.cau.cs.kieler.interactive"
            value="true">
      </option>
      <option
            class="de.cau.cs.kieler.synccharts.Region"
            option="de.cau.cs.kieler.borderSpacing"
            value="1.0">
      </option>
      <semanticOption
            class="de.cau.cs.kieler.synccharts.Scope"
            config="de.cau.cs.kieler.synccharts.diagram.custom.HVLayoutConfig">
      </semanticOption>
      <semanticOption
            class="de.cau.cs.kieler.synccharts.Action"
            config="de.cau.cs.kieler.synccharts.diagram.custom.ActionLayoutConfig">
      </semanticOption>
      <semanticOption
            class="de.cau.cs.kieler.synccharts.Scope"
            config="de.cau.cs.kieler.synccharts.diagram.custom.AnnotationsLayoutConfig">
      </semanticOption>
      <semanticOption
            class="de.cau.cs.kieler.synccharts.Action"
            config="de.cau.cs.kieler.synccharts.diagram.custom.AnnotationsLayoutConfig">
      </semanticOption>
   </extension>
      <extension
         point="org.eclipse.gmf.runtime.diagram.ui.editpolicyProviders">
      <editpolicyProvider
            class="de.cau.cs.kieler.synccharts.diagram.custom.handlers.SyncchartsDeletionPolicyProvider">
         <Priority
               name="Lowest">
         </Priority>
      </editpolicyProvider>
   </extension>
      <extension
            point="org.eclipse.gmf.runtime.common.ui.services.action.globalActionHandlerProviders">
         <GlobalActionHandlerProvider
               class="de.cau.cs.kieler.synccharts.diagram.custom.handlers.SyncchartsCutCopyPasteHandlerProvider"
               id="de.cau.cs.kieler.synccharts.diagram.custom.CutCopyPasteHandler">
            <Priority
                  name="Lowest">
            </Priority>
            <ViewId
                  id="de.cau.cs.kieler.synccharts.diagram.part.SyncchartsDiagramEditorID">
               <ElementType
                     class="org.eclipse.gmf.runtime.diagram.ui.editparts.IGraphicalEditPart">
                  <GlobalActionId
                        actionId="cut">
                  </GlobalActionId>
                  <GlobalActionId
                        actionId="copy">
                  </GlobalActionId>
                  <GlobalActionId
                        actionId="paste">
                  </GlobalActionId>
               </ElementType>
            </ViewId>
         </GlobalActionHandlerProvider>
      </extension>
      <extension
            point="de.cau.cs.kieler.synccharts.triggerListener">
         <triggerListener
               class="de.cau.cs.kieler.synccharts.diagram.custom.triggerlisteners.RedundantLabelTriggerListener">
         </triggerListener>
      </extension>
      <extension
            point="org.eclipse.core.expressions.propertyTesters">
         <propertyTester
               class="de.cau.cs.kieler.synccharts.diagram.custom.handlers.SyncchartsPropertyTester"
               id="de.cau.cs.kieler.synccharts.activeSyncchartsEditor"
               namespace="de.cau.cs.kieler.synccharts"
               properties="activeSyncchartsEditor"
               type="org.eclipse.ui.IEditorPart">
         </propertyTester>
         <propertyTester
               class="de.cau.cs.kieler.synccharts.diagram.custom.handlers.SyncchartsPropertyTester"
               id="de.cau.cs.kieler.synccharts.isKsbaseInactive"
               namespace="de.cau.cs.kieler.synccharts"
               properties="isKsbaseInactive"
               type="org.eclipse.ui.IEditorPart">
         </propertyTester>
      </extension>
      <extension
            point="de.cau.cs.kieler.core.model.Validation">
         <ValidateAction
               actionFactory="de.cau.cs.kieler.synccharts.diagram.custom.SyncchartsValidationActionFactory"
               ePackageId="de.cau.cs.kieler.synccharts">
         </ValidateAction>
      </extension>
      <extension
            point="de.cau.cs.kieler.core.kivi.combinations">
         <combination
               active="true"
               class="de.cau.cs.kieler.synccharts.diagram.custom.HighlightSelectedTransitionsCombination"
               description="This combination highlights all selected transitions in a SyncCharts diagram."
               name="SyncCharts Highlight Selected Transitions">
         </combination>
      </extension>
      <extension
            point="org.eclipse.ui.views.properties.tabbed.propertyTabs">
         <propertyTabs
               contributorId="de.cau.cs.kieler.synccharts.diagram">
            <propertyTab
                  category="domain"
                  id="property.tab.annotations"
                  label="Annotations">
            </propertyTab>
         </propertyTabs>
      </extension>
      <extension
            point="org.eclipse.ui.views.properties.tabbed.propertySections">
         <propertySections
               contributorId="de.cau.cs.kieler.synccharts.diagram">
            <propertySection
                  class="de.cau.cs.kieler.core.annotations.ui.properties.AnnotationsPropertySection"
                  id="property.section.annotations"
                  tab="property.tab.annotations">
               <input type="org.eclipse.gmf.runtime.notation.View"/>
               <input type="org.eclipse.gef.EditPart"/>
               <input type="de.cau.cs.kieler.synccharts.diagram.navigator.SyncchartsAbstractNavigatorItem"/>
            </propertySection>
         </propertySections>
      </extension>
</plugin>
