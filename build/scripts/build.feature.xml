<project name="Build All Elements" default="call.antRunner">

	<property name="scriptdir" location="."/>
	<property file="${scriptdir}/build.general.properties" />
	<!-- property file="/var/lib/tomcat5.5/webapps/hudson/jobs/ImportBuildFiles/workspace/scripts/build.general.properties" / -->
	
	<!-- target calls the eclipse antRunner processing THIS build file on target 'main' -->
	<target name="call.antRunner">
	        <!--  property name="jobdirabs" location="${jobdir}"/ -->
	        <property name="jobdir" location="../../../${job}/workspace"/>
	        <echo message="${jobdir}"/>
		<echo message="${baseLocation}"/>
		<echo message="${baseLocation}/plugins/org.eclipse.equinox.launcher_${equinoxLauncherPluginVersion}.jar"/>
		<java classname="org.eclipse.equinox.launcher.Main" fork="true" failonerror="true">
			<arg value="-configuration" />
			<arg value="/var/lib/tomcat5.5/webapps/hudson/jobs/ImportBuildFiles/workspace/eclipseHome" />
			<arg value="-data" />
			<arg value="/var/lib/tomcat5.5/webapps/hudson/jobs/ImportBuildFiles/workspace/eclipseHome/workspace" />
			<arg value="-clean" />
			<arg value="-consoleLog" />
			<arg value="-application" />
			<arg value="org.eclipse.ant.core.antRunner" />
			<arg value="-buildfile" />
			<arg value="${scriptdir}/build.feature.xml" />
			<arg value="main" />
			<arg value="-Dbasedir=${jobdir}" />
			<arg value="-Dscriptdir=${scriptdir}" />
			<arg value="-DpluginPath=${pluginPath}" />
			<arg value="-DtopLevelElementType=feature" />
			<arg value="-DtopLevelElementId=${part}" />
			<classpath>
				<pathelement location="${baseLocation}/plugins/org.eclipse.equinox.launcher_${equinoxLauncherPluginVersion}.jar" />
			</classpath>
		</java>
	</target>

	<target name="main">
		<echo message="BaseDir ${basedir}"/>
		<echo message="ScriptDir ${scriptdir}"/>
		<echo message="BuildDir ${buildDirectory}"/>
		<echo message="PluginPath ${pluginPath}"/>
		<!--available file="${pluginPath}" property="jarDa" value="gefunden"/ -->
		<!-- property name="jarDa" value="nicht gefunden"/ -->
		<!-- echo message="core....jar ${jarDa}"/ -->
		<!-- antcall target="copy"/ -->
		
	  <mkdir dir="${buildDirectory}/update-site/features" />
	  <mkdir dir="${buildDirectory}/update-site/plugins" />
	  <ant antfile="${baseLocation}/plugins/org.eclipse.pde.build_${pdeBuildPluginVersion}/scripts/build.xml">
	       <target name="generate"/>
	  </ant>
	  <ant antfile="build.xml" dir="${elementPath}">
	      <property name="feature.destination" value="${buildDirectory}/update-site/features"/>
	      <property name="plugin.destination" value="${buildDirectory}/update-site/plugins"/>
	      <target name="build.jars"/>
	      <target name="build.update.jar"/>
	  </ant>
	</target>
	
	<target name="copy"> <!-- if="jarDa"-->
		<echo message="copying"/>
		<copy todir="${buildDirectory}">
			<fileset dir="${buildDirectory}/../../KIELER_core/workspace/update-site/plugins"/>
		</copy>
		<unjar src="${buildDirectory}/../../KIELER_core/workspace/update-site/plugins/de.cau.cs.kieler.core_0.1.1.jar" dest="${buildDirectory}/de.cau.cs.kieler.core_0.1.1/"/>
		<unjar src="${buildDirectory}/../../KIELER_core/workspace/update-site/plugins/de.cau.cs.kieler.core.kgraph_0.1.0.jar" dest="${buildDirectory}/de.cau.cs.kieler.kgraph_0.1.0/"/>
		<unjar src="${buildDirectory}/../../KIELER_core/workspace/update-site/plugins/de.cau.cs.kieler.core.ui_0.1.0.jar" dest="${buildDirectory}/de.cau.cs.kieler.core.ui_0.1.0/"/>
	</target>
	
<!--	      <mkdir dir="${buildDirectory}/update-site"/>
	      <mkdir dir="${buildDirectory}/update-site/features"/>
	      <copy todir="${buildDirectory}/update-site/features">
		  <fileset dir="${buildDirectory}/features">
		      <include name="*.jar"/>
		  </fileset>
	      </copy>
	      <mkdir dir="${buildDirectory}/update-site/plugins"/>
	      <copy todir="${buildDirectory}/update-site/plugins">
		  <fileset dir="${buildDirectory}/plugins">
		      <include name="*.jar"/>
		  </fileset>
	      </copy>
-->
	
</project>
